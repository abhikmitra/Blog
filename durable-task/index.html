<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:100%/1.75 'Merriweather','Georgia',serif;box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.9);font-family:'Merriweather','Georgia',serif;font-weight:400;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}h1{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:Montserrat,sans-serif;font-weight:900;text-rendering:optimizeLegibility;font-size:2.5rem;line-height:1.1;}h2{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:1.73286rem;line-height:1.1;}h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:1.4427rem;line-height:1.1;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.1;letter-spacing:0.140625em;text-transform:uppercase;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:0.83255rem;line-height:1.1;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:0.75966rem;line-height:1.1;font-style:italic;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}ul{margin-left:1.75rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;list-style-position:outside;list-style-image:none;list-style:disc;}ol{margin-left:1.75rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;font-size:0.85rem;line-height:1.75rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;font-size:1rem;line-height:1.75rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}blockquote{margin-left:-1.75rem;margin-right:1.75rem;margin-top:0;padding-bottom:0;padding-left:1.42188rem;padding-right:0;padding-top:0;margin-bottom:1.75rem;font-size:1.20112rem;line-height:1.75rem;color:hsla(0,0%,0%,0.59);font-style:italic;border-left:0.32813rem solid hsla(0,0%,0%,0.9);}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(1.75rem - 1px);background:hsla(0,0%,0%,0.2);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}b{font-weight:700;}strong{font-weight:700;}dt{font-weight:700;}th{font-weight:700;}li{margin-bottom:calc(1.75rem / 2);}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.75rem;margin-bottom:calc(1.75rem / 2);margin-top:calc(1.75rem / 2);}li > ul{margin-left:1.75rem;margin-bottom:calc(1.75rem / 2);margin-top:calc(1.75rem / 2);}blockquote *:last-child{margin-bottom:0;}li *:last-child{margin-bottom:0;}p *:last-child{margin-bottom:0;}li > p{margin-bottom:calc(1.75rem / 2);}code{font-size:0.85rem;line-height:1.75rem;}kbd{font-size:0.85rem;line-height:1.75rem;}samp{font-size:0.85rem;line-height:1.75rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:1.16667rem;padding-right:1.16667rem;padding-top:0.875rem;padding-bottom:calc(0.875rem - 1px);}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}blockquote > :last-child{margin-bottom:0;}blockquote cite{font-size:1rem;line-height:1.75rem;color:hsla(0,0%,0%,0.9);font-weight:400;}blockquote cite:before{content:"— ";}ul,ol{margin-left:0;}@media only screen and (max-width:480px){ul,ol{margin-left:1.75rem;}blockquote{margin-left:-1.3125rem;margin-right:0;padding-left:0.98438rem;}}h1,h2,h3,h4,h5,h6{margin-top:3.5rem;}a{box-shadow:0 1px 0 0 currentColor;color:#007acc;text-decoration:none;}a:hover,a:active{box-shadow:none;}mark,ins{background:#007acc;color:white;padding:0.10938rem 0.21875rem;text-decoration:none;}a.gatsby-resp-image-link{box-shadow:none;}</style><meta data-react-helmet="true" property="og:description" content="Deepdive into inner workings of DTF"/><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml"/><link rel="icon" href="/blog/icons/icon-48x48.png?v=fd6b8e1352aaa808d8b27a40db102c0c"/><link rel="manifest" href="/blog/manifest.webmanifest"/><meta name="theme-color" content="#663399"/><link rel="apple-touch-icon" sizes="48x48" href="/blog/icons/icon-48x48.png?v=fd6b8e1352aaa808d8b27a40db102c0c"/><link rel="apple-touch-icon" sizes="72x72" href="/blog/icons/icon-72x72.png?v=fd6b8e1352aaa808d8b27a40db102c0c"/><link rel="apple-touch-icon" sizes="96x96" href="/blog/icons/icon-96x96.png?v=fd6b8e1352aaa808d8b27a40db102c0c"/><link rel="apple-touch-icon" sizes="144x144" href="/blog/icons/icon-144x144.png?v=fd6b8e1352aaa808d8b27a40db102c0c"/><link rel="apple-touch-icon" sizes="192x192" href="/blog/icons/icon-192x192.png?v=fd6b8e1352aaa808d8b27a40db102c0c"/><link rel="apple-touch-icon" sizes="256x256" href="/blog/icons/icon-256x256.png?v=fd6b8e1352aaa808d8b27a40db102c0c"/><link rel="apple-touch-icon" sizes="384x384" href="/blog/icons/icon-384x384.png?v=fd6b8e1352aaa808d8b27a40db102c0c"/><link rel="apple-touch-icon" sizes="512x512" href="/blog/icons/icon-512x512.png?v=fd6b8e1352aaa808d8b27a40db102c0c"/><title data-react-helmet="true">Durable Task Framework Internals | Abhik&#x27;s Blog</title><meta data-react-helmet="true" name="description" content="Deepdive into inner workings of DTF"/><meta data-react-helmet="true" property="og:title" content="Durable Task Framework Internals"/><meta name="generator" content="Gatsby 2.20.12"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="complancoder"/><meta data-react-helmet="true" name="twitter:title" content="Durable Task Framework Internals"/><meta data-react-helmet="true" name="twitter:description" content="Deepdive into inner workings of DTF"/><style data-href="/blog/styles.6e50da1a5581862dc05b.css">@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:100;src:local("Montserrat Thin "),local("Montserrat-Thin"),url(/blog/static/montserrat-latin-100-191cc9f50f3b76b9617cb383f19acb7d.woff2) format("woff2"),url(/blog/static/montserrat-latin-100-370318464551d5f25b0f0a78f374faac.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:100;src:local("Montserrat Thin italic"),local("Montserrat-Thinitalic"),url(/blog/static/montserrat-latin-100italic-bdeaeb79db315697bd173a55b097dc18.woff2) format("woff2"),url(/blog/static/montserrat-latin-100italic-ecf7d49386e8f265878e735db34a7c4b.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:200;src:local("Montserrat Extra Light "),local("Montserrat-Extra Light"),url(/blog/static/montserrat-latin-200-85d5ef9db7f2dc6979172a4a3b2c57cb.woff2) format("woff2"),url(/blog/static/montserrat-latin-200-1fc98e126a3d152549240e6244d7e669.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:200;src:local("Montserrat Extra Light italic"),local("Montserrat-Extra Lightitalic"),url(/blog/static/montserrat-latin-200italic-49095760a498d024fe1a85a078850df9.woff2) format("woff2"),url(/blog/static/montserrat-latin-200italic-fe46cf8b9462c820457d3bf537e4057f.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:300;src:local("Montserrat Light "),local("Montserrat-Light"),url(/blog/static/montserrat-latin-300-7c3daf12b706645b5d3710f863a4da04.woff2) format("woff2"),url(/blog/static/montserrat-latin-300-8dc95fab9cf98d02ca8d76e97d3dff60.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:300;src:local("Montserrat Light italic"),local("Montserrat-Lightitalic"),url(/blog/static/montserrat-latin-300italic-f20b178ca2024a5eac8e42e6649db86c.woff2) format("woff2"),url(/blog/static/montserrat-latin-300italic-3fe16939288856e8e828fa2661bf2354.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:400;src:local("Montserrat Regular "),local("Montserrat-Regular"),url(/blog/static/montserrat-latin-400-bc3aa95dca08f5fee5291e34959c27bc.woff2) format("woff2"),url(/blog/static/montserrat-latin-400-8102c4838f9e3d08dad644290a9cb701.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:400;src:local("Montserrat Regular italic"),local("Montserrat-Regularitalic"),url(/blog/static/montserrat-latin-400italic-5cad650422a7184467af5a4d17b264c4.woff2) format("woff2"),url(/blog/static/montserrat-latin-400italic-d191f22af3bb50902b99ac577f81a322.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:500;src:local("Montserrat Medium "),local("Montserrat-Medium"),url(/blog/static/montserrat-latin-500-92d16e458625f4d2c8940f6bdca0ff09.woff2) format("woff2"),url(/blog/static/montserrat-latin-500-8b763220218ffc11c57c84ddb80e7b26.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:500;src:local("Montserrat Medium italic"),local("Montserrat-Mediumitalic"),url(/blog/static/montserrat-latin-500italic-47bfcca6b69d6a9acca7a8bff17193e2.woff2) format("woff2"),url(/blog/static/montserrat-latin-500italic-72c01f753c3940c0b9cb6bf2389caddf.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:600;src:local("Montserrat SemiBold "),local("Montserrat-SemiBold"),url(/blog/static/montserrat-latin-600-6fb1b5623e528e27c18658fecf5ee0ee.woff2) format("woff2"),url(/blog/static/montserrat-latin-600-7c839d15a6f54e7025ba8c0c4b333e8f.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:600;src:local("Montserrat SemiBold italic"),local("Montserrat-SemiBolditalic"),url(/blog/static/montserrat-latin-600italic-60789af1c9338ed1a9546722ec54b4f7.woff2) format("woff2"),url(/blog/static/montserrat-latin-600italic-f3d4de8d0afb19e777c79032ce828e3d.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:700;src:local("Montserrat Bold "),local("Montserrat-Bold"),url(/blog/static/montserrat-latin-700-39d93cf678c740f9f6b2b1cfde34bee3.woff2) format("woff2"),url(/blog/static/montserrat-latin-700-80f10bd382f0df1cd650fec59f3c9394.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:700;src:local("Montserrat Bold italic"),local("Montserrat-Bolditalic"),url(/blog/static/montserrat-latin-700italic-ba136d97b14e82284dd595e257f11c47.woff2) format("woff2"),url(/blog/static/montserrat-latin-700italic-8c98142b425630821139c24bd1698700.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:800;src:local("Montserrat ExtraBold "),local("Montserrat-ExtraBold"),url(/blog/static/montserrat-latin-800-b7018be9ed6cd94da8b6675b3a468c3b.woff2) format("woff2"),url(/blog/static/montserrat-latin-800-9a9befcf50d64f9d2d19d8b1d1984add.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:800;src:local("Montserrat ExtraBold italic"),local("Montserrat-ExtraBolditalic"),url(/blog/static/montserrat-latin-800italic-540ffdd223d1a9ad3d4e678e1a23372e.woff2) format("woff2"),url(/blog/static/montserrat-latin-800italic-897086f99f4e1f45e6b1e9368527d0bc.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:900;src:local("Montserrat Black "),local("Montserrat-Black"),url(/blog/static/montserrat-latin-900-58cd789700850375b834e8b6776002eb.woff2) format("woff2"),url(/blog/static/montserrat-latin-900-26d42c9428780e545a540bbb50c84bce.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:900;src:local("Montserrat Black italic"),local("Montserrat-Blackitalic"),url(/blog/static/montserrat-latin-900italic-451157bc8861fe54f523b3669a3def71.woff2) format("woff2"),url(/blog/static/montserrat-latin-900italic-a8ec4957e1c24f5793305763ad9845b3.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:300;src:local("Merriweather Light "),local("Merriweather-Light"),url(/blog/static/merriweather-latin-300-b1158cfcd4aacb9d8fb61625e37af46a.woff2) format("woff2"),url(/blog/static/merriweather-latin-300-cc7de05e166e90320d7d896e0f72a19d.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:300;src:local("Merriweather Light italic"),local("Merriweather-Lightitalic"),url(/blog/static/merriweather-latin-300italic-8fe52a48089d6ebe46db0b8e7cc66263.woff2) format("woff2"),url(/blog/static/merriweather-latin-300italic-e1331f5397c2a673f9d3765138debdb5.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:400;src:local("Merriweather Regular "),local("Merriweather-Regular"),url(/blog/static/merriweather-latin-400-8276fdb72ae8f4714d4e6eba704cc39f.woff2) format("woff2"),url(/blog/static/merriweather-latin-400-69f09800f4f6479d06e44eba837df872.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:400;src:local("Merriweather Regular italic"),local("Merriweather-Regularitalic"),url(/blog/static/merriweather-latin-400italic-3a9be9ea9f7aa4af6de7307df21d9fc0.woff2) format("woff2"),url(/blog/static/merriweather-latin-400italic-d76079ed7541a433a54f79316de086e9.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:700;src:local("Merriweather Bold "),local("Merriweather-Bold"),url(/blog/static/merriweather-latin-700-fa534be7ffa380e39a7f6e03bf9a5e03.woff2) format("woff2"),url(/blog/static/merriweather-latin-700-ba56ea84b8084b7ff9677f50d3cd81bd.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:700;src:local("Merriweather Bold italic"),local("Merriweather-Bolditalic"),url(/blog/static/merriweather-latin-700italic-1ef5edaaa20ae53ea50399884c5e48c6.woff2) format("woff2"),url(/blog/static/merriweather-latin-700italic-534bc9e7ce93c73d73426e46acd78092.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:900;src:local("Merriweather Black "),local("Merriweather-Black"),url(/blog/static/merriweather-latin-900-7528fb70e8a4a82c7305e72ff43ac25f.woff2) format("woff2"),url(/blog/static/merriweather-latin-900-3799b6e2f5ed3fcccf9d7a708d7419fa.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:900;src:local("Merriweather Black italic"),local("Merriweather-Blackitalic"),url(/blog/static/merriweather-latin-900italic-e1b4d2aaa78e12ad84aaf8a56321e4c2.woff2) format("woff2"),url(/blog/static/merriweather-latin-900italic-2ae22f731b3424e8dbb4b37f7ca6e708.woff) format("woff")}code[class*=language-],pre[class*=language-]{color:#000;background:none;text-shadow:0 1px #fff;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-]::selection,code[class*=language-] ::selection,pre[class*=language-]::selection,pre[class*=language-] ::selection{text-shadow:none;background:#b3d4fc}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#f5f2f0}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#999}.token.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{color:#9a6e3a;background:hsla(0,0%,100%,.5)}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.class-name,.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}</style><link as="script" rel="preload" href="/blog/component---src-templates-blog-post-js-603e003d35c7316a3610.js"/><link as="script" rel="preload" href="/blog/69ca9dfa785447e3d8b116b383997bcdc8df623a-e846e6165360833579bc.js"/><link as="script" rel="preload" href="/blog/commons-137268e2e738c6cae6d8.js"/><link as="script" rel="preload" href="/blog/app-dbad51b9d1e4d238b79e.js"/><link as="script" rel="preload" href="/blog/framework-624f79e66261973aaa49.js"/><link as="script" rel="preload" href="/blog/styles-55b12e3f12e70f5e0cab.js"/><link as="script" rel="preload" href="/blog/webpack-runtime-de8665d2f5c34e0754a9.js"/><link as="fetch" rel="preload" href="/blog/page-data\durable-task\page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/blog/page-data\app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div style="margin-left:auto;margin-right:auto;max-width:42rem;padding:2.625rem 1.3125rem"><header><h3 style="font-family:Montserrat, sans-serif;margin-top:0"><a style="box-shadow:none;color:inherit" href="/blog/">Abhik&#x27;s Blog</a></h3></header><main><article><header><h1 style="margin-top:1.75rem;margin-bottom:0">Durable Task Framework Internals</h1><p style="font-size:0.83255rem;line-height:1.75rem;display:block;margin-bottom:1.75rem">April 23, 2020</p></header><section><h3>Durable Task Framework</h3>
<p>The Durable Task Framework is an orchestration framework for dot net apps. You can read more about it in their official <a href="https://github.com/Azure/durabletask">github repo</a>. This <a href="https://channel9.msdn.com/Shows/On-NET/Building-workflows-with-the-Durable-Task-Framework">channel 9 video</a> does a pretty good job of explaining about the framework.</p>
<p>While I was reading through the materials , I felt the literature out their treated the system as a blackbox and I could’nt find any material on the web on how does DTF works under the hood. So I cloned DTF repo and added console logs to understand how it works. The following details apply to <a href="https://www.nuget.org/packages/DurableTask.Core/">DurableTask.Core</a> version 2.0.0.6 which maps to commit id <code class="language-text">0a93eba6c9692f52776dac0f3741eccad3293ef6</code> in the DTF Github repo.</p>
<h3>Setup</h3>
<p>My setup has 2 console apps , DTFDemoWorker and DTFClient. DTFDemoWorker houses the hubWorker and creates the resources. I have 1 Orchestration called a TestOrchestration which does 2 activities, testActivity1 and TestActivity2 both of which console logs to the console and waits for sometime to simulate some work being done.</p>
<p>You can find the repo <a href="https://github.com/abhikmitra/DTFDemo">here</a> </p>
<p>When we create the resources DTF creates 3 Queues in the Service Bus </p>
<ul>
<li>&#x3C;TaskHubName>/orchestrator</li>
<li>&#x3C;TaskHubName>/tracking</li>
<li>&#x3C;TaskHubName>/worker
. </li>
</ul>
<h3>Steps</h3>
<p>We will see whats the process in which Orchestrator provides reliability. We will ignore the tracking Queue for now and add that later. To kepe the diagrams simple , lets assume we just have 1 Task that gets invoked.</p>
<ol>
<li>
<p>We start the process with the following code from the Client.</p>
<div class="gatsby-highlight" data-language="c#"><pre class="language-c#"><code class="language-c#">var instance = client.CreateOrchestrationInstanceAsync(typeof(TestOrchestration), &quot;InstanceId5302&quot;, &quot;Test Input&quot;).Result;</code></pre></div>
</li>
<li>This will send a message with event name <code class="language-text">ExecutionStarted</code> message into the Orchestrator queue.There will be other details such as the orchestration name and id , that will help DTF to operate on teh correct instance of orchestration.</li>
</ol>
<div class="gatsby-highlight" data-language="mermaid"><pre class="language-mermaid"><code class="language-mermaid">sequenceDiagram
    Client-&gt;&gt;Orchestrator: ExecutionStarted</code></pre></div>
<ol start="3">
<li>This is received by the hub &#x26; the actual <a href="https://github.com/abhikmitra/DTFDemo/blob/master/Domains/TestOrchestration.cs">TestOrchestration</a> code is invoked. As you can see in the link above , I have put in log statements and 2 log statements are invoked.</li>
</ol>
<div class="gatsby-highlight" data-language="mermaid"><pre class="language-mermaid"><code class="language-mermaid">sequenceDiagram
    Client--&gt;&gt;Orchestrator: ExecutionStarted

    Orchestrator--&gt;&gt;Hub: ExecutionStarted

    Hub-&gt;&gt;TestOrchestration: Orchestration Invoked</code></pre></div>
<ol start="4">
<li>
<p>Assume the orchestration code is as below. The orchestration runs till <code class="language-text">scheduleWithRetry</code> and prints <code class="language-text">Running Orchestration</code> into the console. Since this is the first time orchestration is running <code class="language-text">Is replaying</code> is set to false. </p>
<div class="gatsby-highlight" data-language="c#"><pre class="language-c#"><code class="language-c#">Console.WriteLine(&quot;Is Replaying =&quot; + context.IsReplaying);
Console.WriteLine(&quot;Running Orchestration&quot;);</code></pre></div>
</li>
</ol>
<p>await context.ScheduleWithRetry<bool>(typeof(TestActivity1), options, "");</p>
<p>Console.WriteLine(“Orchestration Finished”);
return result; </p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">When the orchestration encounters an activity it puts a message into the Worker Queue and exits the orchestration. The rest of the orchestration is not executed.

```mermaid
sequenceDiagram
    Client--&gt;&gt;Orchestrator: ExecutionStarted

    Orchestrator--&gt;&gt;Hub: ExecutionStarted

    Hub-&gt;&gt;TestOrchestration: Orchestration Invoked
    Hub--&gt;&gt;Worker: TaskScheduled</code></pre></div>
<ol start="5">
<li>
<p>The hub is also listening to the Worker Queue and picks up the <code class="language-text">TaskScheduled</code> message and invokes the TaskActivity. For now lets assume all the TaskActivity does is a console log. So the task is immediately completed. When the task is completed the hub queues TaskCompleted event in the Orchestrator queue.</p>
<div class="gatsby-highlight" data-language="mermaid"><pre class="language-mermaid"><code class="language-mermaid">sequenceDiagram
Client--&gt;&gt;Orchestrator: ExecutionStarted

Orchestrator--&gt;&gt;Hub: ExecutionStarted

Hub-&gt;&gt;TestOrchestration: Orchestration Invoked
Hub--&gt;&gt;Worker: TaskScheduled
Worker--&gt;&gt;Hub: Task Scheduled
Hub-&gt;&gt;TaskActivity: Task Invoked
Hub--&gt;&gt;Orchestrator: TaskCompleted</code></pre></div>
</li>
<li>The Orchestration wakes up moment the hub detects a message in the Orchestrator Queue and <em>restarts the Orchestration from the beginning</em>. So all the logs that got printed last time gets printed again. Since this is the second time orchestration is running <code class="language-text">Is replaying</code> is set to <em>True</em>.</li>
</ol>
<div class="gatsby-highlight" data-language="mermaid"><pre class="language-mermaid"><code class="language-mermaid">sequenceDiagram
   Client--&gt;&gt;Orchestrator: ExecutionStarted

   Orchestrator--&gt;&gt;Hub: ExecutionStarted

   Hub-&gt;&gt;TestOrchestration: Orchestration Invoked
   Hub--&gt;&gt;Worker: TaskScheduled
   Worker--&gt;&gt;Hub: Task Scheduled
   Hub-&gt;&gt;TaskActivity: Task Invoked
   Orchestrator--&gt;&gt;Hub: TaskCompleted
   Hub-&gt;&gt;TestOrchestration: Orchestration Invoked &amp; Completed</code></pre></div>
<ol start="7">
<li>What happens when the the Hub fails in Step #5 while it is running the taskActivity ?</li>
<li>In a distributed system , we have to work with teh assumption that the hub can fail any time and so can the task. </li>
<li>The hub does not remove the TaskScheduledEvent unless the TasActivity is complete. So if in case the hub goes down, the service bus message will be present in teh queue. When the hub comes back , it will start from step 5 as if nothing had happened.</li>
<li>
<p>What if, the Task itself throws an exception  ? </p>
<div class="gatsby-highlight" data-language="mermaid"><pre class="language-mermaid"><code class="language-mermaid">sequenceDiagram
Client--&gt;&gt;Orchestrator: ExecutionStarted
Orchestrator--&gt;&gt;Hub: ExecutionStarted
Hub-&gt;&gt;TestOrchestration: Orchestration Invoked
Hub--&gt;&gt;Worker: TaskScheduled
Worker--&gt;&gt;Hub: Task Scheduled
Hub-&gt;&gt;TaskActivity: Task Invoked
Note right of TaskActivity: Throws Exception!
Hub--&gt;&gt;Orchestrator: TaskFailed
Orchestrator--&gt;&gt;Hub: TaskFailed
Hub-&gt;&gt;TestOrchestration: Orchestration Invoked
note left of TestOrchestration: Error Handling &lt;br/&gt; Runs  till &lt;br/&gt;ScheduleWithRetry
Hub--&gt;&gt;Orchestrator: Timer Fired
Orchestrator--&gt;&gt;Hub: Timer Fired
Hub-&gt;&gt;TestOrchestration: Orchestration Invoked
Hub--&gt;&gt;Worker: TaskScheduled
note left of TestOrchestration: Happy path restarts</code></pre></div>
</li>
<li>How does DTF remember the results of each task Activity ?</li>
<li>DTF serializes all the events into orchestration messages (Session State) that it puts in service bus. For eg,
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 562px;"
    >
      <a
    class="gatsby-resp-image-link"
    href="/blog/static/2798b67dcb285c283fb0a0df1e938e67/6e88f/serializedState.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 90.54054054054053%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAC2UlEQVQ4y41U2XLaQBDk/38pfsAgdF+AjQAJCYG5BOZK7HKVXe5MjwA7lYdEVVO7O9rt6Znp3cb++RnbaovtdoePjw98fn7i+nH9L3t/f8f5fMbb2xteX1/R2Gw2KPICHPmjnE4xeBxgmCSoqgq73e6/7FmIcWzkeY4szbATx+FwwHq9xmKxwHK5FNbbvw4ySLWplADn3HM1BZxkGcIgRDJIdOzGXYyGQ/R7PZ3TojBCr1vPk8EA02KKoiiQpukNlERIqJGJ0zQ68DwfVseE53qwTAuBF4j58BxPAfnPsV0kyRCJlGQ8HmM0GgnQBi8vL5Ly7gvQ6lhwHRdxFAmzPjoSwBcw13YExBHAUP57F1AHpoyt+5YEtrXeo+EIT08LHI9HNFKJ5FgObMtW0JqNpT6y5Uh/GASwzXoPMyCoI3PDMDT44DGpAcdCmw7LNNFsNuuDtq2pEtgXUJbDNARAgpKl0Wqj3TIQRTHWq7VK7lZDMrQZUYwM2BjzkrLnupoi2ROU7DzPQ5ZNMJ/NJc0nGWcoyxIzWStgPplcUgq1EawjmxHJ2vd99XsCGviBNCLFRPbPBISMKK2FgC6kfgRXQJWNH2q9yKrX7Um6dYA4jgUo1LRjSY+1Y93YAN6ujXR4tVqpEfwGyI1sBpn6kpLv1szoIzMGISh9/W5fdcrL8PDwoOC/fv0UUW+/aqi68+tmhCIR1iwKYwFxNQilZF406ooWW817PdNuG1LPTK8sBf4HQ/OiMWqOHVX5SOf5jyW4Nodsr9lMpyVO55MC8bYoYDHJVaTcUOvRugndkjlFzvW9sLr7cSeAfb3HtLUY7y/1dwNM07Hqy+YNEEaUxRWQnU6ls6UwYWlYt1wI5JdOM11293Q6faXM7sznc3Vsqssr8u014bO03+91M0f6CULjnB3mY1GWM2XZ4FPFJ+xwOGqk78ZUvtt+f8BS9rPLqbDjWQLzBSrkHWWA38xfAK69acTIAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Serialized state"
        title="Serialized state"
        src="/blog/static/2798b67dcb285c283fb0a0df1e938e67/6e88f/serializedState.png"
        srcset="/blog/static/2798b67dcb285c283fb0a0df1e938e67/12f09/serializedState.png 148w,
/blog/static/2798b67dcb285c283fb0a0df1e938e67/e4a3f/serializedState.png 295w,
/blog/static/2798b67dcb285c283fb0a0df1e938e67/6e88f/serializedState.png 562w"
        sizes="(max-width: 562px) 100vw, 562px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span> all of this tasks is serialized into the messages.</li>
</ol></section><hr style="margin-bottom:1.75rem"/><footer><div style="display:flex;margin-bottom:4.375rem"><div class=" gatsby-image-wrapper" style="position:relative;overflow:hidden;display:inline-block;width:50px;height:50px;margin-right:0.875rem;margin-bottom:0;min-width:50px;border-radius:100%"><img aria-hidden="true" src="data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAwAC/8QAFQEBAQAAAAAAAAAAAAAAAAAAAgP/2gAMAwEAAhADEAAAARJ1hYp4LCVeK1I//8QAGxAAAgIDAQAAAAAAAAAAAAAAAQMAAhESITL/2gAIAQEAAQUCfDvlXm1NytZYQkrluHJqFnn/xAAZEQADAAMAAAAAAAAAAAAAAAAAARECEDH/2gAIAQMBAT8BqFIZd1//xAAZEQACAwEAAAAAAAAAAAAAAAAAAQIQETH/2gAIAQIBAT8BSHukeV//xAAaEAADAAMBAAAAAAAAAAAAAAAAARECIXFB/9oACAEBAAY/AsEPKmi2JDr0RbQulXo+n//EABsQAQADAQADAAAAAAAAAAAAAAEAETEhQYHB/9oACAEBAAE/IUWxewnY3JVVmrin9DObVUQ0lg/a7mE+Ubk7qJ7E/9oADAMBAAIAAwAAABBkH4P/xAAXEQEBAQEAAAAAAAAAAAAAAAABEQAQ/9oACAEDAQE/EGjc0Hp//8QAGBEBAAMBAAAAAAAAAAAAAAAAAQAQETH/2gAIAQIBAT8QTDISjJwr/8QAHBABAAMBAAMBAAAAAAAAAAAAAQARITFhcZFR/9oACAEBAAE/EMcN2Lf0irYHBlHHxyX/AEPXwR+7O1ar4fIpMxhScITZ1HD6fkaBjP3rBOiBeopkFUn/2Q==" alt="Abhik Mitra" style="position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition-delay:500ms;border-radius:50%"/><noscript><picture><source srcset="/blog/static/f693cb87ce63b88a182a754d2cdcea1a/99438/profile-pic.jpg 1x,
/blog/static/f693cb87ce63b88a182a754d2cdcea1a/aba1d/profile-pic.jpg 1.5x,
/blog/static/f693cb87ce63b88a182a754d2cdcea1a/b315d/profile-pic.jpg 2x" /><img loading="lazy" width="50" height="50" srcset="/blog/static/f693cb87ce63b88a182a754d2cdcea1a/99438/profile-pic.jpg 1x,
/blog/static/f693cb87ce63b88a182a754d2cdcea1a/aba1d/profile-pic.jpg 1.5x,
/blog/static/f693cb87ce63b88a182a754d2cdcea1a/b315d/profile-pic.jpg 2x" src="/blog/static/f693cb87ce63b88a182a754d2cdcea1a/99438/profile-pic.jpg" alt="Abhik Mitra" style="position:absolute;top:0;left:0;opacity:1;width:100%;height:100%;object-fit:cover;object-position:center"/></picture></noscript></div><p>Written by <strong>Abhik Mitra</strong> <!-- -->who lives in Bangalore and loves building and learning new things.<!-- --> <a href="https://twitter.com/complancoder">You should follow him on Twitter</a></p></div></footer></article><nav><ul style="display:flex;flex-wrap:wrap;justify-content:space-between;list-style:none;padding:0"><li><a rel="prev" href="/blog/hello-world/">← <!-- -->Hello World - Starting a new Blog Series</a></li><li></li></ul></nav></main><footer><hr/></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/durable-task/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-dbad51b9d1e4d238b79e.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-603e003d35c7316a3610.js"],"component---src-pages-404-js":["/component---src-pages-404-js-c720a9d310a7ee983590.js"],"component---src-pages-index-js":["/component---src-pages-index-js-3e411bcc26221725175e.js"]};/*]]>*/</script><script src="/blog/webpack-runtime-de8665d2f5c34e0754a9.js" async=""></script><script src="/blog/styles-55b12e3f12e70f5e0cab.js" async=""></script><script src="/blog/framework-624f79e66261973aaa49.js" async=""></script><script src="/blog/app-dbad51b9d1e4d238b79e.js" async=""></script><script src="/blog/commons-137268e2e738c6cae6d8.js" async=""></script><script src="/blog/69ca9dfa785447e3d8b116b383997bcdc8df623a-e846e6165360833579bc.js" async=""></script><script src="/blog/component---src-templates-blog-post-js-603e003d35c7316a3610.js" async=""></script></body></html>